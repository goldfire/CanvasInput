/*!
 *  CanvasInput v1.2.6
 *  http://goldfirestudios.com/blog/108/CanvasInput-HTML5-Canvas-Text-Input
 *
 *  (c) 2013-2017, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
!function(){var e=[],o=window.CanvasInput=function(o){var t=this;o=o?o:{},t._canvas=o.canvas||null,t._ctx=t._canvas?t._canvas.getContext("2d"):null,t._x=o.x||0,t._y=o.y||0,t._extraX=o.extraX||0,t._extraY=o.extraY||0,t._fontSize=o.fontSize||14,t._fontFamily=o.fontFamily||"Arial",t._fontColor=o.fontColor||"#000",t._placeHolderColor=o.placeHolderColor||"#bfbebd",t._fontWeight=o.fontWeight||"normal",t._fontStyle=o.fontStyle||"normal",t._fontShadowColor=o.fontShadowColor||"",t._fontShadowBlur=o.fontShadowBlur||0,t._fontShadowOffsetX=o.fontShadowOffsetX||0,t._fontShadowOffsetY=o.fontShadowOffsetY||0,t._readonly=o.readonly||!1,t._maxlength=o.maxlength||null,t._width=o.width||150,t._height=o.height||t._fontSize,t._padding=o.padding<0?5:o.padding,t._borderWidth=o.borderWidth<0?1:o.borderWidth,t._borderColor=o.borderColor||"#959595",t._borderRadius=o.borderRadius<0?3:o.borderRadius,t._backgroundImage=o.backgroundImage||"",t._boxShadow=o.boxShadow||"1px 1px 0px rgba(255, 255, 255, 1)",t._innerShadow=o.innerShadow||"0px 0px 4px rgba(0, 0, 0, 0.4)",t._selectionColor=o.selectionColor||"rgba(179, 212, 253, 0.8)",t._placeHolder=o.placeHolder||"",t._value=(o.value||t._placeHolder)+"",t._onsubmit=o.onsubmit||function(){},t._onkeydown=o.onkeydown||function(){},t._onkeyup=o.onkeyup||function(){},t._onfocus=o.onfocus||function(){},t._onblur=o.onblur||function(){},t._cursor=!1,t._cursorPos=0,t._hasFocus=!1,t._selection=[0,0],t._wasOver=!1,t.boxShadow(t._boxShadow,!0),t._calcWH(),t._renderCanvas=document.createElement("canvas"),t._renderCanvas.setAttribute("width",t.outerW),t._renderCanvas.setAttribute("height",t.outerH),t._renderCtx=t._renderCanvas.getContext("2d"),t._shadowCanvas=document.createElement("canvas"),t._shadowCanvas.setAttribute("width",t._width+2*t._padding),t._shadowCanvas.setAttribute("height",t._height+2*t._padding),t._shadowCtx=t._shadowCanvas.getContext("2d"),void 0!==o.backgroundGradient?(t._backgroundColor=t._renderCtx.createLinearGradient(0,0,0,t.outerH),t._backgroundColor.addColorStop(0,o.backgroundGradient[0]),t._backgroundColor.addColorStop(1,o.backgroundGradient[1])):t._backgroundColor=o.backgroundColor||"#fff",t._canvas&&(t._canvas.addEventListener("mousemove",function(e){e=e||window.event,t.mousemove(e,t)},!1),t._canvas.addEventListener("mousedown",function(e){e=e||window.event,t.mousedown(e,t)},!1),t._canvas.addEventListener("mouseup",function(e){e=e||window.event,t.mouseup(e,t)},!1));var n=function(e){e=e||window.event,t._hasFocus&&!t._mouseDown&&t.blur()};window.addEventListener("mouseup",n,!0),window.addEventListener("touchend",n,!0),t._hiddenInput=document.createElement("input"),t._hiddenInput.type="text",t._hiddenInput.style.position="absolute",t._hiddenInput.style.opacity=0,t._hiddenInput.style.pointerEvents="none",t._hiddenInput.style.zIndex=0,t._updateHiddenInput(),t._maxlength&&(t._hiddenInput.maxLength=t._maxlength),document.body.appendChild(t._hiddenInput),t._hiddenInput.value=t._value,t._hiddenInput.addEventListener("keydown",function(e){e=e||window.event,t._hasFocus&&(window.focus(),t._hiddenInput.focus(),t.keydown(e,t))}),t._hiddenInput.addEventListener("keyup",function(e){e=e||window.event,t._value=t._hiddenInput.value,t._cursorPos=t._hiddenInput.selectionStart,t._selection=[t._hiddenInput.selectionStart,t._hiddenInput.selectionEnd],t.render(),t._hasFocus&&t._onkeyup(e,t)}),e.push(t),t._inputsIndex=e.length-1,t.render()};o.prototype={canvas:function(e){var o=this;return void 0!==e?(o._canvas=e,o._ctx=o._canvas.getContext("2d"),o.render()):o._canvas},x:function(e){var o=this;return void 0!==e?(o._x=e,o._updateHiddenInput(),o.render()):o._x},y:function(e){var o=this;return void 0!==e?(o._y=e,o._updateHiddenInput(),o.render()):o._y},extraX:function(e){var o=this;return void 0!==e?(o._extraX=e,o._updateHiddenInput(),o.render()):o._extraX},extraY:function(e){var o=this;return void 0!==e?(o._extraY=e,o._updateHiddenInput(),o.render()):o._extraY},fontSize:function(e){var o=this;return void 0!==e?(o._fontSize=e,o.render()):o._fontSize},fontFamily:function(e){var o=this;return void 0!==e?(o._fontFamily=e,o.render()):o._fontFamily},fontColor:function(e){var o=this;return void 0!==e?(o._fontColor=e,o.render()):o._fontColor},placeHolderColor:function(e){var o=this;return void 0!==e?(o._placeHolderColor=e,o.render()):o._placeHolderColor},fontWeight:function(e){var o=this;return void 0!==e?(o._fontWeight=e,o.render()):o._fontWeight},fontStyle:function(e){var o=this;return void 0!==e?(o._fontStyle=e,o.render()):o._fontStyle},fontShadowColor:function(e){var o=this;return void 0!==e?(o._fontShadowColor=e,o.render()):o._fontShadowColor},fontShadowBlur:function(e){var o=this;return void 0!==e?(o._fontShadowBlur=e,o.render()):o._fontShadowBlur},fontShadowOffsetX:function(e){var o=this;return void 0!==e?(o._fontShadowOffsetX=e,o.render()):o._fontShadowOffsetX},fontShadowOffsetY:function(e){var o=this;return void 0!==e?(o._fontShadowOffsetY=e,o.render()):o._fontShadowOffsetY},width:function(e){var o=this;return void 0!==e?(o._width=e,o._calcWH(),o._updateCanvasWH(),o._updateHiddenInput(),o.render()):o._width},height:function(e){var o=this;return void 0!==e?(o._height=e,o._calcWH(),o._updateCanvasWH(),o._updateHiddenInput(),o.render()):o._height},padding:function(e){var o=this;return void 0!==e?(o._padding=e,o._calcWH(),o._updateCanvasWH(),o.render()):o._padding},borderWidth:function(e){var o=this;return void 0!==e?(o._borderWidth=e,o._calcWH(),o._updateCanvasWH(),o.render()):o._borderWidth},borderColor:function(e){var o=this;return void 0!==e?(o._borderColor=e,o.render()):o._borderColor},borderRadius:function(e){var o=this;return void 0!==e?(o._borderRadius=e,o.render()):o._borderRadius},backgroundColor:function(e){var o=this;return void 0!==e?(o._backgroundColor=e,o.render()):o._backgroundColor},backgroundGradient:function(e){var o=this;return void 0!==e?(o._backgroundColor=o._renderCtx.createLinearGradient(0,0,0,o.outerH),o._backgroundColor.addColorStop(0,e[0]),o._backgroundColor.addColorStop(1,e[1]),o.render()):o._backgroundColor},boxShadow:function(e,o){var t=this;if(void 0===e)return t._boxShadow;var n=e.split("px ");return t._boxShadow={x:"none"===t._boxShadow?0:parseInt(n[0],10),y:"none"===t._boxShadow?0:parseInt(n[1],10),blur:"none"===t._boxShadow?0:parseInt(n[2],10),color:"none"===t._boxShadow?"":n[3]},t._boxShadow.x<0?(t.shadowL=Math.abs(t._boxShadow.x)+t._boxShadow.blur,t.shadowR=t._boxShadow.blur+t._boxShadow.x):(t.shadowL=Math.abs(t._boxShadow.blur-t._boxShadow.x),t.shadowR=t._boxShadow.blur+t._boxShadow.x),t._boxShadow.y<0?(t.shadowT=Math.abs(t._boxShadow.y)+t._boxShadow.blur,t.shadowB=t._boxShadow.blur+t._boxShadow.y):(t.shadowT=Math.abs(t._boxShadow.blur-t._boxShadow.y),t.shadowB=t._boxShadow.blur+t._boxShadow.y),t.shadowW=t.shadowL+t.shadowR,t.shadowH=t.shadowT+t.shadowB,t._calcWH(),o?void 0:(t._updateCanvasWH(),t.render())},innerShadow:function(e){var o=this;return void 0!==e?(o._innerShadow=e,o.render()):o._innerShadow},selectionColor:function(e){var o=this;return void 0!==e?(o._selectionColor=e,o.render()):o._selectionColor},placeHolder:function(e){var o=this;return void 0!==e?(o._placeHolder=e,o.render()):o._placeHolder},value:function(e){var o=this;return void 0!==e?(o._value=e+"",o._hiddenInput.value=e+"",o._cursorPos=o._clipText().length,o.render(),o):o._value===o._placeHolder?"":o._value},onsubmit:function(e){var o=this;return void 0!==e?(o._onsubmit=e,o):void o._onsubmit()},onkeydown:function(e){var o=this;return void 0!==e?(o._onkeydown=e,o):void o._onkeydown()},onkeyup:function(e){var o=this;return void 0!==e?(o._onkeyup=e,o):void o._onkeyup()},focus:function(o){var t=this;if(!t._hasFocus){t._onfocus(t);for(var n=0;n<e.length;n++)e[n]._hasFocus&&e[n].blur()}t._selectionUpdated?delete t._selectionUpdated:t._selection=[0,0],t._hasFocus=!0,t._readonly?t._hiddenInput.readOnly=!0:(t._hiddenInput.readOnly=!1,t._cursorPos="number"==typeof o?o:t._clipText().length,t._placeHolder===t._value&&(t._value="",t._hiddenInput.value=""),t._cursor=!0,t._cursorInterval&&clearInterval(t._cursorInterval),t._cursorInterval=setInterval(function(){t._cursor=!t._cursor,t.render()},500));var r=t._selection[0]>0||t._selection[1]>0;return t._hiddenInput.focus(),t._hiddenInput.selectionStart=r?t._selection[0]:t._cursorPos,t._hiddenInput.selectionEnd=r?t._selection[1]:t._cursorPos,t.render()},blur:function(e){var o=e||this;return o._onblur(o),o._cursorInterval&&clearInterval(o._cursorInterval),o._hasFocus=!1,o._cursor=!1,o._selection=[0,0],o._hiddenInput.blur(),""===o._value&&(o._value=o._placeHolder),o.render()},keydown:function(o,t){{var n=o.which;o.shiftKey}if(!t._readonly&&t._hasFocus){if(t._onkeydown(o,t),65===n&&(o.ctrlKey||o.metaKey))return t.selectText(),o.preventDefault(),t.render();if(17===n||o.metaKey||o.ctrlKey)return t;if(13===n)o.preventDefault(),t._onsubmit(o,t);else if(9===n&&(o.preventDefault(),e.length>1)){var r=e[t._inputsIndex+1]?t._inputsIndex+1:0;t.blur(),setTimeout(function(){e[r].focus()},10)}return t._value=t._hiddenInput.value,t._cursorPos=t._hiddenInput.selectionStart,t._selection=[0,0],t.render()}},click:function(e,o){var t=o._mousePos(e),n=t.x,r=t.y;return o._endSelection?(delete o._endSelection,void delete o._selectionUpdated):o._canvas&&o._overInput(n,r)||!o._canvas?o._mouseDown?(o._mouseDown=!1,o.click(e,o),o.focus(o._clickPos(n,r))):void 0:o.blur()},mousemove:function(e,o){var t=o._mousePos(e),n=t.x,r=t.y,a=o._overInput(n,r);if(a&&o._canvas?(o._canvas.style.cursor="text",o._wasOver=!0):o._wasOver&&o._canvas&&(o._canvas.style.cursor="default",o._wasOver=!1),o._hasFocus&&o._selectionStart>=0){var d=o._clickPos(n,r),i=Math.min(o._selectionStart,d),_=Math.max(o._selectionStart,d);if(!a)return o._selectionUpdated=!0,o._endSelection=!0,delete o._selectionStart,void o.render();(o._selection[0]!==i||o._selection[1]!==_)&&(o._selection=[i,_],o.render())}},mousedown:function(e,o){var t=o._mousePos(e),n=t.x,r=t.y,a=o._overInput(n,r);o._mouseDown=a,o._hasFocus&&a&&(o._selectionStart=o._clickPos(n,r))},mouseup:function(e,o){var t=o._mousePos(e),n=t.x,r=t.y,a=o._clickPos(n,r)!==o._selectionStart;o._hasFocus&&o._selectionStart>=0&&o._overInput(n,r)&&a?(o._selectionUpdated=!0,delete o._selectionStart,o.render()):delete o._selectionStart,o.click(e,o)},selectText:function(e){var o=this,e=e||[0,o._value.length];return setTimeout(function(){o._selection=[e[0],e[1]],o._hiddenInput.selectionStart=e[0],o._hiddenInput.selectionEnd=e[1],o.render()},1),o},renderCanvas:function(){return this._renderCanvas},render:function(){var e=this,o=e._renderCtx,t=e.outerW,n=e.outerH,r=e._borderRadius,a=e._borderWidth,d=e.shadowW,i=e.shadowH;o&&(o.clearRect(0,0,o.canvas.width,o.canvas.height),o.shadowOffsetX=e._boxShadow.x,o.shadowOffsetY=e._boxShadow.y,o.shadowBlur=e._boxShadow.blur,o.shadowColor=e._boxShadow.color,e._borderWidth>0&&(o.fillStyle=e._borderColor,e._roundedRect(o,e.shadowL,e.shadowT,t-d,n-i,r),o.fill(),o.shadowOffsetX=0,o.shadowOffsetY=0,o.shadowBlur=0),e._drawTextBox(function(){o.shadowOffsetX=0,o.shadowOffsetY=0,o.shadowBlur=0;var _=e._clipText(),s=e._padding+e._borderWidth+e.shadowT;if(e._selection[1]>0){var u=e._textWidth(_.substring(0,e._selection[0])),l=e._textWidth(_.substring(e._selection[0],e._selection[1]));o.fillStyle=e._selectionColor,o.fillRect(s+u,s,l,e._height)}if(e._cursor){var h=e._textWidth(_.substring(0,e._cursorPos));o.fillStyle=e._fontColor,o.fillRect(s+h,s,1,e._height)}var c=e._padding+e._borderWidth+e.shadowL,f=Math.round(s+e._height/2);_=""===_&&e._placeHolder?e._placeHolder:_,o.fillStyle=""!==e._value&&e._value!==e._placeHolder?e._fontColor:e._placeHolderColor,o.font=e._fontStyle+" "+e._fontWeight+" "+e._fontSize+"px "+e._fontFamily,o.shadowColor=e._fontShadowColor,o.shadowBlur=e._fontShadowBlur,o.shadowOffsetX=e._fontShadowOffsetX,o.shadowOffsetY=e._fontShadowOffsetY,o.textAlign="left",o.textBaseline="middle",o.fillText(_,c,f);var v=e._innerShadow.split("px "),w="none"===e._innerShadow?0:parseInt(v[0],10),p="none"===e._innerShadow?0:parseInt(v[1],10),x="none"===e._innerShadow?0:parseInt(v[2],10),b="none"===e._innerShadow?"":v[3];if(x>0){var g=e._shadowCtx,S=g.canvas.width,C=g.canvas.height;g.clearRect(0,0,S,C),g.shadowBlur=x,g.shadowColor=b,g.shadowOffsetX=0,g.shadowOffsetY=p,g.fillRect(-1*t,-100,3*t,100),g.shadowOffsetX=w,g.shadowOffsetY=0,g.fillRect(S,-1*n,100,3*n),g.shadowOffsetX=0,g.shadowOffsetY=p,g.fillRect(-1*t,C,3*t,100),g.shadowOffsetX=w,g.shadowOffsetY=0,g.fillRect(-100,-1*n,100,3*n),e._roundedRect(o,a+e.shadowL,a+e.shadowT,t-2*a-d,n-2*a-i,r),o.clip(),o.drawImage(e._shadowCanvas,0,0,S,C,a+e.shadowL,a+e.shadowT,S,C)}return e._ctx&&(e._ctx.clearRect(e._x,e._y,o.canvas.width,o.canvas.height),e._ctx.drawImage(e._renderCanvas,e._x,e._y)),e}))},destroy:function(){var o=this,t=e.indexOf(o);-1!=t&&e.splice(t,1),o._hasFocus&&o.blur(),document.body.removeChild(o._hiddenInput),o._renderCanvas=null,o._shadowCanvas=null,o._renderCtx=null},_drawTextBox:function(e){var o=this,t=o._renderCtx,n=o.outerW,r=o.outerH,a=o._borderRadius,d=o._borderWidth,i=o.shadowW,_=o.shadowH;if(""===o._backgroundImage)t.fillStyle=o._backgroundColor,o._roundedRect(t,d+o.shadowL,d+o.shadowT,n-2*d-i,r-2*d-_,a),t.fill(),e();else{var s=new Image;s.src=o._backgroundImage,s.onload=function(){t.drawImage(s,0,0,s.width,s.height,d+o.shadowL,d+o.shadowT,n,r),e()}}},_clearSelection:function(){var e=this;if(e._selection[1]>0){var o=e._selection[0],t=e._selection[1];return e._value=e._value.substr(0,o)+e._value.substr(t),e._cursorPos=o,e._cursorPos=e._cursorPos<0?0:e._cursorPos,e._selection=[0,0],!0}return!1},_clipText:function(e){var o=this;e=void 0===e?o._value:e;var t=o._textWidth(e),n=t/(o._width-o._padding),r=n>1?e.substr(-1*Math.floor(e.length/n)):e;return r+""},_textWidth:function(e){var o=this,t=o._renderCtx;return t.font=o._fontStyle+" "+o._fontWeight+" "+o._fontSize+"px "+o._fontFamily,t.textAlign="left",t.measureText(e).width},_calcWH:function(){var e=this;e.outerW=e._width+2*e._padding+2*e._borderWidth+e.shadowW,e.outerH=e._height+2*e._padding+2*e._borderWidth+e.shadowH},_updateCanvasWH:function(){var e=this,o=e._renderCanvas.width,t=e._renderCanvas.height;e._renderCanvas.setAttribute("width",e.outerW),e._renderCanvas.setAttribute("height",e.outerH),e._shadowCanvas.setAttribute("width",e._width+2*e._padding),e._shadowCanvas.setAttribute("height",e._height+2*e._padding),e._ctx&&e._ctx.clearRect(e._x,e._y,o,t)},_updateHiddenInput:function(){var e=this;e._hiddenInput.style.left=e._x+e._extraX+(e._canvas?e._canvas.offsetLeft:0)+"px",e._hiddenInput.style.top=e._y+e._extraY+(e._canvas?e._canvas.offsetTop:0)+"px",e._hiddenInput.style.width=e._width+2*e._padding+"px",e._hiddenInput.style.height=e._height+2*e._padding+"px"},_roundedRect:function(e,o,t,n,r,a){2*a>n&&(a=n/2),2*a>r&&(a=r/2),e.beginPath(),e.moveTo(o+a,t),e.lineTo(o+n-a,t),e.quadraticCurveTo(o+n,t,o+n,t+a),e.lineTo(o+n,t+r-a),e.quadraticCurveTo(o+n,t+r,o+n-a,t+r),e.lineTo(o+a,t+r),e.quadraticCurveTo(o,t+r,o,t+r-a),e.lineTo(o,t+a),e.quadraticCurveTo(o,t,o+a,t),e.closePath()},_overInput:function(e,o){var t=this,n=e>=t._x+t._extraX,r=e<=t._x+t._extraX+t._width+2*t._padding,a=o>=t._y+t._extraY,d=o<=t._y+t._extraY+t._height+2*t._padding;return n&&r&&a&&d},_clickPos:function(e){var o=this,t=o._value;o._value===o._placeHolder&&(t="");var n=o._clipText(t),r=0,a=n.length;if(e-(o._x+o._extraX)<o._textWidth(n))for(var d=0;d<n.length;d++)if(r+=o._textWidth(n[d]),r>=e-(o._x+o._extraX)){a=d;break}return a},_mousePos:function(e){var o=e.target,t=e.pageX,n=e.pageY;e.touches&&e.touches.length?(o=e.touches[0].target,t=e.touches[0].pageX,n=e.touches[0].pageY):e.changedTouches&&e.changedTouches.length&&(o=e.changedTouches[0].target,t=e.changedTouches[0].pageX,n=e.changedTouches[0].pageY);var r=document.defaultView.getComputedStyle(o,void 0),a=parseInt(r.paddingLeft,10)||0,d=parseInt(r.paddingLeft,10)||0,i=parseInt(r.borderLeftWidth,10)||0,_=parseInt(r.borderLeftWidth,10)||0,s=document.body.parentNode.offsetTop||0,u=document.body.parentNode.offsetLeft||0,l=0,h=0;if(void 0!==o.offsetParent)do l+=o.offsetLeft,h+=o.offsetTop;while(o=o.offsetParent);return l+=a+i+u,h+=d+_+s,{x:t-l,y:n-h}}},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=window.CanvasInput),exports.CanvasInput=window.CanvasInput):"undefined"!=typeof define&&define.amd?define("CanvasInput",function(){return root.CanvasInput=window.CanvasInput}()):root.CanvasInput=window.CanvasInput}();